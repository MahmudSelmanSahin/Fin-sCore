@page
@model DashboardModel
@{
    ViewData["Title"] = "İnteraktif Şube - Ana Sayfa";
    ViewData["UseAppContainer"] = false;
}

<div class="dashboard">
    <!-- Navigation Bar -->
    <nav class="dashboard__navbar" id="mainNavbar">
        <div class="dashboard__navbar_container">
            <!-- Top Row -->
            <div class="navbar__top_row">
                <a href="/Dashboard" class="navbar__logo">
                    <img src="~/img/interaktif_kredi_logo.png" alt="İnteraktif Kredi" class="navbar__logo_img" />
                </a>
                
                <div class="navbar__top_menu">
                    <a href="/About" class="navbar__top_link">Biz Kimiz?</a>
                    <a href="/Reports" class="navbar__top_link">Raporlar</a>
                    <a href="/LoanCalculator" class="navbar__top_link">Kredi Hesaplama</a>
                    <a href="#help-center" class="navbar__top_link">Destek & SSS</a>
                </div>
                
                <div class="navbar__actions">
                    <button type="button" class="navbar__notification" id="notificationBtn">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span class="navbar__badge">3</span>
                    </button>
                    <a href="/Profile" class="navbar__btn_primary" title="Profil">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </nav>
    <!-- Navbar Spacer -->
    <div class="dashboard__navbar_spacer dashboard__navbar_spacer--compact"></div>
    
    <!-- Welcome Section with Credit Stats -->
    <section class="dashboard__welcome_section">
        <div class="dashboard__welcome_wrapper">
            <div class="dashboard__welcome_card dashboard__welcome_card--contained">
                <div class="dashboard__welcome_content">
                    <h1 class="dashboard__title">Hoşgeldin</h1>
                    <p class="dashboard__subtitle">İnteraktif kredi ile rahat bir <strong>Nefes Alın</strong></p>
                </div>
                
                <!-- Credit Stats Below Text -->
                <div class="dashboard__credit_stats dashboard__credit_stats--row">
                    <div class="credit_stat">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="2" y="5" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 10h20" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Toplam Kredi Limiti</span>
                            <span class="credit_stat__value">@Model.TotalCreditLimit.ToString("N0") ₺</span>
                        </div>
                    </div>
                    
                    <div class="credit_stat">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Kredi Skoru</span>
                            <span class="credit_stat__value">@Model.CreditScore</span>
                        </div>
                    </div>
                    
                    <a href="#active-loans" class="credit_stat credit_stat--clickable">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" stroke="currentColor" stroke-width="2"/>
                                <rect x="8" y="2" width="8" height="4" rx="1" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Aktif Kredi</span>
                            <span class="credit_stat__value">@Model.ActiveLoans.Count Adet</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Action Cards Section -->
    <section class="dashboard__action_cards">
        <div class="action_cards_grid">
            <a href="/Reports" class="action_card">
                <div class="action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="action_card__content">
                    <h3 class="action_card__title">Raporlar & Faturalar</h3>
                    <p class="action_card__description">Kredi raporlarınızı ve faturalarınızı görüntüleyin</p>
                </div>
                <div class="action_card__arrow">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>
            <a href="/Profile" class="action_card">
                <div class="action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="action_card__content">
                    <h3 class="action_card__title">Profil Yönetimi</h3>
                    <p class="action_card__description">Hesap bilgilerinizi ve ayarlarınızı yönetin</p>
                </div>
                <div class="action_card__arrow">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>
        </div>
    </section>

    <!-- Quick Actions -->
    <section class="dashboard__quick_actions">
        <h2 class="section_title">Hızlı İşlemler</h2>
        <div class="quick_actions_grid">
            <a href="/LoanCalculator" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="4" y="2" width="16" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 6h8M8 10h2M8 14h2M8 18h2M14 14h2M14 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Kredi Hesaplama</h3>
                <p class="quick_action_card__description">Aylık taksit tutarınızı hesaplayın</p>
            </a>

            <a href="/LoanApplication" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Kredi Başvurusu</h3>
                <p class="quick_action_card__description">Yeni kredi başvurusu yapın</p>
            </a>

            <a href="/Payment" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Ödeme Yap</h3>
                <p class="quick_action_card__description">Kredi taksitinizi ödeyin</p>
            </a>

            <a href="/Reports" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Raporlar</h3>
                <p class="quick_action_card__description">Kredi raporlarınızı görüntüleyin</p>
            </a>
        </div>
    </section>

    <!-- Active Loans -->
    @if (Model.ActiveLoans.Any())
    {
        <section class="dashboard__active_loans" id="active-loans">
            <div class="section_header">
                <h2 class="section_title">Aktif Kredileriniz</h2>
                <a href="/Loans" class="section_link">Tümünü Gör</a>
            </div>
            <div class="loans_grid">
                @foreach (var loan in Model.ActiveLoans)
                {
                    <div class="loan_card">
                        <div class="loan_card__header">
                            <div class="loan_card__header_info">
                                <h3 class="loan_card__title">@loan.LoanType</h3>
                                <span class="loan_card__bank">@loan.BankName</span>
                            </div>
                            <span class="loan_card__badge loan_card__badge--active">Aktif</span>
                        </div>
                        <div class="loan_card__content">
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Kredi Tutarı:</span>
                                <span class="loan_card__value">@loan.LoanAmount.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Kalan Borç:</span>
                                <span class="loan_card__value loan_card__value--highlight">@loan.RemainingAmount.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Aylık Taksit:</span>
                                <span class="loan_card__value">@loan.MonthlyPayment.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Sonraki Ödeme:</span>
                                <span class="loan_card__value">@loan.NextPaymentDate.ToString("dd MMMM yyyy")</span>
                            </div>
                        </div>
                        <div class="loan_card__progress">
                            <div class="progress_bar">
                                <div class="progress_bar__fill" data-progress="@loan.CompletionPercentage.ToString("F0")"></div>
                            </div>
                            <p class="progress_label">@loan.RemainingInstallments / @loan.InstallmentNumber taksit kaldı</p>
                        </div>
                        <div class="loan_card__actions loan_card__actions--centered">
                            <a href="@loan.BankPaymentUrl" target="_blank" rel="noopener noreferrer" class="btn_primary btn_primary--small btn_primary--full">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="btn_icon">
                                    <path d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8zM6 1v3M10 1v3M14 1v3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Ödeme Yap
                            </a>
                        </div>
                    </div>
                }
            </div>
        </section>
    }

    <!-- Help Center (CMS - JSON Data) -->
    <section class="dashboard__help_center" id="help-center">
        <div class="section_header">
            <h2 class="section_title">Yardım & Destek Merkezi</h2>
            <a href="/Help" class="section_link">Tümünü Gör</a>
        </div>
        <div class="help_center_grid">
            @foreach (var item in Model.HelpCenterItems.Take(4))
            {
                <a href="@item.Link" class="help_center_card">
                    <div class="help_center_card__icon">
                        @switch (item.Icon)
                        {
                            case "document":
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                                    <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                break;
                            case "calculator":
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="4" y="2" width="16" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                                    <path d="M8 6h8M8 10h2M8 14h2M8 18h2M14 14h2M14 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                break;
                            case "help":
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                break;
                            case "phone":
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                break;
                        }
                    </div>
                    <div class="help_center_card__content">
                        <h3 class="help_center_card__title">@item.Title</h3>
                        <p class="help_center_card__description">@item.Description</p>
                        <span class="help_center_card__category">@item.Category</span>
                    </div>
                </a>
            }
        </div>
    </section>
</div>

@section Scripts {
    <script src="~/js/navbar.js" asp-append-version="true"></script>
    <script src="~/js/dashboard.js" asp-append-version="true"></script>
}

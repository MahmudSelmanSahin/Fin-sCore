@page
@model DashboardModel
@{
    ViewData["Title"] = "İnteraktif Şube - Ana Sayfa";
    ViewData["UseAppContainer"] = false;
}

<div class="dashboard">
    <!-- Navigation Bar -->
    <nav class="dashboard__navbar" id="mainNavbar">
        <div class="dashboard__navbar_container">
            <!-- Top Row -->
            <div class="navbar__top_row">
                <a href="/Dashboard" class="navbar__logo">
                    <img src="~/img/interaktif_kredi_logo.png" alt="İnteraktif Kredi" class="navbar__logo_img" />
                </a>
                
                <div class="navbar__top_menu">
                    <a href="/AboutUs" class="navbar__top_link">Biz Kimiz?</a>
                    <a href="/ReportDetails" class="navbar__top_link">Raporlar</a>
                    <a href="/LoanCalculator" class="navbar__top_link">Kredi Hesaplama</a>
                    <a href="#help-center" class="navbar__top_link">Destek & SSS</a>
                </div>
                
                <div class="navbar__actions">
                    <div class="profile_dropdown" id="profileDropdown">
                        <button type="button" class="navbar__btn_primary" id="profileDropdownBtn" title="Profil">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="profile_dropdown__menu" id="profileDropdownMenu">
                            <a href="/Profile" class="profile_dropdown__item">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span>Profil</span>
                            </a>
                            <button type="button" class="profile_dropdown__item profile_dropdown__item--logout" id="logoutBtn">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M16 17l5-5-5-5M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span>Çıkış Yap</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <!-- Navbar Spacer -->
    <div class="dashboard__navbar_spacer dashboard__navbar_spacer--compact"></div>
    
    <!-- Welcome Section with Credit Stats -->
    <section class="dashboard__welcome_section">
        <div class="dashboard__welcome_wrapper">
            <div class="dashboard__welcome_card dashboard__welcome_card--contained">
                <div class="dashboard__welcome_content">
                    <h1 class="dashboard__title">Hoşgeldin</h1>
                    <p class="dashboard__subtitle">İnteraktif kredi ile rahat bir <strong>Nefes Alın</strong></p>
                </div>
                
                <!-- Credit Stats Below Text -->
                <div class="dashboard__credit_stats dashboard__credit_stats--row">
                    <div class="credit_stat">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="2" y="5" width="20" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M2 10h20" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Toplam Kredi Limiti</span>
                            <span class="credit_stat__value">@Model.TotalCreditLimit.ToString("N0") ₺</span>
                        </div>
                    </div>
                    
                    <div class="credit_stat">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Bu Ayın Ödeme Tutarı</span>
                            <span class="credit_stat__value">@Model.MonthlyPaymentDue.ToString("N2") ₺</span>
                        </div>
                    </div>
                    
                    <a href="#active-loans" class="credit_stat credit_stat--clickable">
                        <span class="credit_stat__icon">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" stroke="currentColor" stroke-width="2"/>
                                <rect x="8" y="2" width="8" height="4" rx="1" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </span>
                        <div class="credit_stat__info">
                            <span class="credit_stat__label">Aktif Kredi</span>
                            <span class="credit_stat__value">@Model.ActiveLoans.Count Adet</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Action Cards Section -->
    <section class="dashboard__action_cards">
        <div class="action_cards_grid">
            <a href="/ReportDetails" class="action_card">
                <div class="action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="action_card__content">
                    <h3 class="action_card__title">Raporlar & Faturalar</h3>
                    <p class="action_card__description">Kredi raporlarınızı ve faturalarınızı görüntüleyin</p>
                </div>
                <div class="action_card__arrow">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>
            <a href="/Profile" class="action_card">
                <div class="action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="action_card__content">
                    <h3 class="action_card__title">Profil Yönetimi</h3>
                    <p class="action_card__description">Hesap bilgilerinizi ve ayarlarınızı yönetin</p>
                </div>
                <div class="action_card__arrow">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </a>

        </div>
    </section>

    <!-- Quick Actions -->
    <section class="dashboard__quick_actions">
        <h2 class="section_title">Hızlı İşlemler</h2>
        <div class="quick_actions_grid">
            <a href="/LoanCalculator" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="4" y="2" width="16" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 6h8M8 10h2M8 14h2M8 18h2M14 14h2M14 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Kredi Hesaplama</h3>
                <p class="quick_action_card__description">Aylık taksit tutarınızı hesaplayın</p>
            </a>

            <a href="/ReportDetails?tab=credit_offers" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Kredi Başvurusu</h3>
                <p class="quick_action_card__description">Yeni kredi başvurusu yapın</p>
            </a>



            <a href="/ReportDetails" class="quick_action_card">
                <div class="quick_action_card__icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="quick_action_card__title">Raporlar</h3>
                <p class="quick_action_card__description">Kredi raporlarınızı görüntüleyin</p>
            </a>
        </div>
    </section>

    <!-- Active Loans -->
    @if (Model.ActiveLoans.Any())
    {
        <section class="dashboard__active_loans" id="active-loans">
            <div class="section_header">
                <h2 class="section_title">Aktif Kredileriniz</h2>
                <a href="/Loans" class="section_link">Tümünü Gör</a>
            </div>
            <div class="loans_grid">
                @foreach (var loan in Model.ActiveLoans)
                {
                    <div class="loan_card">
                        <div class="loan_card__header">
                            <div class="loan_card__header_info">
                                <h3 class="loan_card__title">@loan.LoanType</h3>
                                <span class="loan_card__bank">@loan.BankName</span>
                            </div>
                        </div>
                        <div class="loan_card__content">
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Kredi Tutarı:</span>
                                <span class="loan_card__value">@loan.LoanAmount.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Kalan Borç:</span>
                                <span class="loan_card__value loan_card__value--highlight">@loan.RemainingAmount.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Aylık Taksit:</span>
                                <span class="loan_card__value">@loan.MonthlyPayment.ToString("N2") ₺</span>
                            </div>
                            <div class="loan_card__info_row">
                                <span class="loan_card__label">Sonraki Ödeme:</span>
                                <span class="loan_card__value">@loan.NextPaymentDate.ToString("dd MMMM yyyy")</span>
                            </div>
                        </div>
                        <div class="loan_card__progress">
                            <div class="progress_bar">
                                <div class="progress_bar__fill" data-progress="@loan.CompletionPercentage.ToString("F0")"></div>
                            </div>
                            <p class="progress_label">@loan.RemainingInstallments / @loan.InstallmentNumber taksit kaldı</p>
                        </div>
                        <div class="loan_card__actions loan_card__actions--centered">
                            <a href="@loan.BankPaymentUrl" target="_blank" rel="noopener noreferrer" class="btn_primary btn_primary--small btn_primary--full">
                                Ödeme Yap
                            </a>
                        </div>
                    </div>
                }
            </div>
        </section>
    }

    <!-- Help Center (CMS - JSON Data) -->
    <section class="dashboard__help_center" id="help-center">
        <div class="section_header">
            <h2 class="section_title">Yardım & Destek Merkezi</h2>
        </div>
        <div class="help_center_grid">
            @foreach (var item in Model.HelpCenterItems)
            {
                if (item.IsClickable && !string.IsNullOrEmpty(item.Link))
                {
                    <a href="@item.Link" class="help_center_card">
                        <div class="help_center_card__icon">
                            @switch (item.Icon)
                            {
                                case "document":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    break;
                                case "calculator":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="4" y="2" width="16" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                                        <path d="M8 6h8M8 10h2M8 14h2M8 18h2M14 14h2M14 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    break;
                                case "help":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    break;
                                case "phone":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    break;
                            }
                        </div>
                        <div class="help_center_card__content">
                            <h3 class="help_center_card__title">@item.Title</h3>
                            <p class="help_center_card__description">@item.Description</p>
                            <span class="help_center_card__category">@item.Category</span>
                        </div>
                    </a>
                }
                else
                {
                    <div class="help_center_card help_center_card--static">
                        <div class="help_center_card__icon">
                            @switch (item.Icon)
                            {
                                case "document":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    break;
                                case "calculator":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect x="4" y="2" width="16" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                                        <path d="M8 6h8M8 10h2M8 14h2M8 18h2M14 14h2M14 18h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    break;
                                case "help":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                    break;
                                case "phone":
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                                    </svg>
                                    break;
                            }
                        </div>
                        <div class="help_center_card__content">
                            <h3 class="help_center_card__title">@item.Title</h3>
                            <p class="help_center_card__description">@item.Description</p>
                            <span class="help_center_card__category">@item.Category</span>
                        </div>
                    </div>
                }
            }
        </div>
    </section>

    <!-- SSS (Sıkça Sorulan Sorular) -->
    @if (Model.FaqItems.Any())
    {
        <section class="dashboard__faq_section" id="faq">
            <div class="section_header">
                <h2 class="section_title">Sıkça Sorulan Sorular</h2>
            </div>
            <div class="faq_accordion">
                @foreach (var faq in Model.FaqItems.Take(6))
                {
                    <div class="faq_item" data-faq-id="@faq.Id">
                        <button type="button" class="faq_item__header">
                            <span class="faq_item__question">@faq.Question</span>
                            <svg class="faq_item__icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        <div class="faq_item__content">
                            <p class="faq_item__answer">@faq.Answer</p>
                            <span class="faq_item__category">@faq.Category</span>
                        </div>
                    </div>
                }
            </div>
        </section>
    }
</div>

@section Scripts {
    <script src="~/js/navbar.js" asp-append-version="true"></script>
    <script src="~/js/dashboard.js" asp-append-version="true"></script>
}
